[
  {
    "path": "tidyverse/",
    "title": "tidyverse第一課:基礎資料變換與整理",
    "description": "這篇文章告訴大家如何製作圖表",
    "author": [
      {
        "name": "董宸賓",
        "url": {}
      }
    ],
    "date": "2023-08-19",
    "categories": [],
    "contents": "\n\nContents\n先載入tidyverse\n寫入一組數據\n讓我們先來觀察這組示範的data\n使用filter過濾資料\n使用select選擇資料\n使用mutate新增資料欄\n使用group_by+summarise做分組摘要\n使用pivot_wider和pivot_longer聚集和分散資料\n讓arrange幫助你排序資料\n\n\n\n\n\n\n\n先載入tidyverse\ninstall.packages(\"tidyverse\")\nlibrary(tidyverse)\n寫入一組數據\n\n\ndata1 <-read.csv(\"https://docs.google.com/spreadsheets/d/e/2PACX-1vTpPg1erFUhXC6sKzUajLFeeBrdcPrugTyTWj8ly1tS4KS3h9yN31i4sq2NoGnHQ4_1M3rtbu1fo8XK/pub?gid=0&single=true&output=csv\")\n\n\n讓我們先來觀察這組示範的data\n\n\npaged_table(data1)\n\n\n\n\n每組資料欄下，都有三個英文字，他們代表著各欄資料的類型， 以下列出7種不同類型：\nint 代表整數\ndbl代表doubles (雙精度浮點數）或實數\nchr代表字元向量（character vectors）或字串\ndttm代表日期與時間\nlgl代表邏輯向量,只包含TRUE或FALSE\nfctr代表因子\ndate代表日期\n使用filter過濾資料\nfilter是使用比較運算子對資料欄做基本的運算\n公式：filter(要過濾的資料, 過濾資料欄的運算式)\n示範：找出”2015年到2019年中，屬於民事案件且超過30件”\n\n\ndata2<- data1%>%\n  filter(案件類型==\"民事\",案件數量 > 30)\n\n\n\ndata2\n\n\n\n圖表\n\n\nShow code\n\nggplot(data1,aes(年度,案件數量))+\n  geom_point(size=4)+\n  geom_point(size=4,color=\"red\",data = data2)+\n  labs(title= \"2015年到2019年中，民事案件超過30件的年份\")+\n  theme_classic()+\n  theme(text=element_text(family=\"黑體-繁 中黑\", size=15))\n\n\n\n\n使用select選擇資料\nselect是能讓妳挑選想要的數據，尤其是你的資料欄十分巨大\n公式：select(你的資料，欄資料名)\n示範：\n\n\ndata3<- data1%>%\n select(年度,案件類型,案件數量)\n\n\n\ndata3\n\n\n\n包含…關鍵字選擇\nstart_with(“關鍵字”)\nend_with(“關鍵字”)\ncontains(“關鍵字”)\n示範：找出名字有案件的欄位\n\n\ndata3.1<- data1%>%\n select(contains(\"案件\"))\n\n\n\n\n\n搭配evevrything挑整資料順序\nselect可以挑整資料欄的順序\n而搭配everything()可以讓你單純改變欄位順序\n示範：將年度欄放在案件類型之後\n\n\ndata3.2<- data1%>%\n select(案件類型,年度,everything())\n\n\n\n\n\n\n使用mutate新增資料欄\nmutate能讓你新增欄位\n公式：mutate(你的資料,新欄位名 = 運算)\n範例:找出不同年度的剩餘案件數\n\n\ndata4<- data1%>%\n  mutate(剩餘案件數=案件數量-結案數)%>%\n  select(年度,案件類型,剩餘案件數)\n\n\n\ndata2\n\n\n\n圖表\n\n\nShow code\n\nggplot(data4,aes(年度,剩餘案件數,fill = 案件類型))+\n  geom_bar(width=1,stat = \"identity\")+\n  facet_wrap(~ 案件類型, ncol = 1)+\n  labs(title= \"2015年到2019年民事與刑事分別的剩餘案件數\")+\n  scale_fill_manual( values = c(\"#004AAD\",\"red\"))+\n  theme_classic()+\n  theme(text=element_text(family=\"黑體-繁 中黑\", size=15),legend.position = \"none\")\n\n\n\n\n使用group_by+summarise做分組摘要\nsummarise()本身的作用是產出濃縮的資料欄\n範例:data1中所有案件數的平均值\n\n\nsummarise(data1,平均值= mean(案件數量))\n\n  平均值\n1   27.3\n\n但，這對我們整理或閱讀資料顯然沒有太大大的幫助\n但搭配group_by能讓我們一組別的方式做整理（所有的dplyr都能搭配group_by）\n範例:找出不同年度的案件總數\n\n\ndata5<- data1%>%\n  group_by(年度)%>%\n  summarise(案件總數 = mean(案件數量)*2)\n\n\n\ndata2\n\n\n\n圖表\n\n\nShow code\n\nggplot(data5,aes(年度,案件總數))+\n  geom_line(linewidth=1, colour=\"#004AAD\")+\n  labs(title= \"2015年到2019年的案件總數\")+\n  theme_classic()+\n  theme(text=element_text(family=\"黑體-繁 中黑\", size=15),legend.position = \"none\")+\n  coord_cartesian(ylim=c(0,100))\n\n\n\n\n使用pivot_wider和pivot_longer聚集和分散資料\n除了篩選，改變資料，tidyverse還可以幫助你的資料變得更整齊\n閱讀以下資料欄，如果我要你比較每年刑法與民法案件發師的次數，是非常不直覺的，\n\n\n\n而這時候，pivot_wider分散資料就相當有用\n公式：pivot_wider(你的資料,values_from = 含有值的欄, names_from = 含有名字的欄)\n範例：\n\n\ndata6.1<-\n  data6%>%\n  pivot_wider(names_from = \"案件類型\",values_from = \"案件數量\")\ndatatable(data6.1)\n\n\n\n既然可以用wider來分散來讓資料更好閱讀，當然也可以用longer來聚焦幫助分析\n範例：\n\n\ndata6.2<-\n  data6.1%>%\n  pivot_longer(c(\"刑事\",\"民事\"),names_to = \"案件類型\", values_to = \"案件數量\")\ndatatable(data6.2)\n\n\n\n讓arrange幫助你排序資料\n\n注意看，這兩個表格有些不同\n\n\n\n\n\n   年度 案件類型 案件數量\n1  2015     民事       23\n2  2016     民事       45\n3  2017     民事       46\n4  2018     民事       13\n5  2019     民事       22\n6  2015     刑事       24\n7  2016     刑事       31\n8  2017     刑事       28\n9  2018     刑事       23\n10 2019     刑事       18\n\n\n\n\n   年度 案件類型 案件數量\n1  2015     刑事       24\n2  2015     民事       23\n3  2016     刑事       31\n4  2016     民事       45\n5  2017     刑事       28\n6  2017     民事       46\n7  2018     刑事       23\n8  2018     民事       13\n9  2019     刑事       18\n10 2019     民事       22\n\n\n\njill\n\n\n\n",
    "preview": {},
    "last_modified": "2023-10-12T14:26:32+08:00",
    "input_file": {}
  }
]
